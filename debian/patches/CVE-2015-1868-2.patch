diff --git a/pdns/dnsparser.cc b/pdns/dnsparser.cc
index a1e21bc..c844f86 100644
--- a/pdns/dnsparser.cc
+++ b/pdns/dnsparser.cc
@@ -494,6 +494,8 @@ void PacketReader::getLabelFromContent(const vector<uint8_t>& content, uint16_t&
       }
       ret.append(1,'.');
     }
+    if (ret.length() > 1024)
+      throw MOADNSException("Total name too long");
   }
 }
 
